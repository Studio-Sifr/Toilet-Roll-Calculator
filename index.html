<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paper Conversion Calculator</title>

<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f5f5;
    color: #333;
    margin: 20px;
}

h1 { text-align:center; color:#2c3e50; }
h2 { text-align:center; margin-bottom:10px; }

section {
    padding: 15px 20px;
    margin-bottom: 20px;
    border-radius: 8px;
    border-left: 8px solid transparent;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    text-align:center;
}

/* Pastel accents */
#exchangeRateSection { border-color:#5d6d7e; background:#ebedef; }
#paperSpec { border-color:#5dade2; background:#eaf2fb; }
#rawMaterial { border-color:#3498db; background:#eaf2fb; }
#packaging { border-color:#2ecc71; background:#e8f8f5; }
#production { border-color:#f1c40f; background:#fff8e1; }
#overheads { border-color:#e67e22; background:#fef5e7; }
#localTransport { border-color:#9b59b6; background:#f5eaf8; }
#exportFreight { border-color:#e74c3c; background:#fdecea; }
#finalSummary { border-color:#48c9b0; background:#e8f8f5; }
#sellingPrice { border-color:#f1948a; background:#fdecea; }

/* Inputs */
label { display:block; margin:8px 0 2px; font-weight:600; }
input {
    font-weight:bold;
    padding:6px 8px;
    width:100%;
    max-width:200px;
    border:1px solid #ccc;
    border-radius:4px;
}

/* Outputs */
.output { font-weight:bold; margin-top:8px; display:block; }

/* Table */
table {
    width:100%;
    border-collapse:collapse;
    margin-top:15px;
    background:#fff;
    border-radius:6px;
    overflow:hidden;
}
td {
    padding:10px;
}
td.label {
    font-weight:700;
}
td.value {
    text-align:right;
    font-weight:600;
}

/* WhatsApp Button */
#whatsappBtn {
    padding:10px 20px;
    font-weight:bold;
    background:#25D366;
    color:white;
    border:none;
    border-radius:5px;
    cursor:pointer;
    margin-top:15px;
}
#whatsappBtn img { width:20px; vertical-align:middle; margin-right:5px; }
</style>
</head>

<body>

<h1>Paper Conversion Calculator</h1>

<section id="exchangeRateSection">
<h2>ğŸ’± Exchange Rate</h2>
<label>PKR â†’ USD</label>
<input type="text" id="exchangeRate" value="280">
</section>

<section id="paperSpec">
<h2>ğŸ“„ Paper Specification</h2>
<label>Ply</label><input type="number" id="ply" value="2">
<label>GSM (per ply)</label><input type="number" id="gsm" value="15">
<label>Sheets per Roll</label><input type="number" id="sheets" value="500">
<label>Sheet Width (cm)</label><input type="number" id="sheetWidth" value="10">
<label>Sheet Length (cm)</label><input type="number" id="sheetLength" value="10">
<span class="output">Tissue Weight (g): <span id="tissueWeight">0.000</span></span>
</section>

<section id="rawMaterial">
<h2>ğŸ’° Raw Material</h2>
<label>Tissue Cost / Ton (USD)</label><input id="tissueCostTon" value="1100">
<label>Core Paper / Ton (USD)</label><input id="coreCostTon" value="635">
<label>Core Weight (g)</label><input id="coreWeight" value="4.0">
<label>Wastage (%)</label><input id="wastage" value="3">
<span class="output">Total Raw Material / Roll: $<span id="totalRawMaterial">0.000</span></span>
</section>

<section id="packaging">
<h2>ğŸ“¦ Packaging</h2>
<label>Single Roll Wrap (PKR)</label><input id="singleWrap" value="1.2">
<label>Bundle Wrap (PKR)</label><input id="bundleWrap" value="20">
<label>Rolls / Bundle</label><input id="rollsPerBundle" value="10">
<span class="output">Packaging / Roll: $<span id="packagingCost">0.000</span></span>
</section>

<section id="production">
<h2>âš¡ Production & Electricity</h2>
<label>Connected Load (kW)</label><input id="load" value="65">
<label>Average Usage (%)</label><input id="usage" value="65">
<label>Unit Rate (PKR)</label><input id="unitRate" value="70">
<label>Rolls / Hour</label><input id="rollsPerHour" value="600">
<label>Hours / Shift</label><input id="hours" value="9">
<label>Shifts / Day</label><input id="shifts" value="2">
<label>Days / Month</label><input id="days" value="26">
<span class="output">Rolls / Month: <span id="monthlyProduction">0</span></span>
<span class="output">Electricity / Roll: $<span id="elecCostRoll">0.000</span></span>
</section>

<section id="overheads">
<h2>ğŸ¢ Overheads</h2>
<label>Rent (PKR)</label><input id="rent" value="450000">
<label>Labor (PKR)</label><input id="labor" value="250000">
<label>Misc (PKR)</label><input id="misc" value="20000">
<span class="output">Overheads / Roll: $<span id="overheadPerRoll">0.000</span></span>
</section>

<section id="localTransport">
<h2>ğŸšš Local Transport & Handling</h2>
<label>Local Transport / Container (PKR)</label><input id="localTransportPKR" value="140000">
<label>Clearing Charges (USD)</label><input id="clearingUSD" value="150">
<label>Rolls / Container</label><input id="rollsPerContainerLocal" value="60340">
<span class="output">Local Transport / Roll: $<span id="localTransportCost">0.000</span></span>
</section>

<section id="exportFreight">
<h2>ğŸŒŠ Export Freight</h2>
<label>Ocean Freight (USD)</label><input id="oceanFreight" value="2000">
<label>Rolls / Container</label><input id="rollsPerContainerExport" value="60340">
<span class="output">Freight / Roll: $<span id="freightPerRoll">0.000</span></span>
</section>

<section id="finalSummary">
<h2>ğŸ’² Final Cost Breakdown</h2>

<span class="output">Cost / Roll (USD): $<span id="costPerRoll">0.000</span></span>
<span class="output">Cost / Ton (USD): $<span id="costPerTon">0.000</span></span>

<table>
<tr><td class="label">Raw Material</td><td class="value" id="breakRaw"></td><td class="value" id="breakRawPct"></td></tr>
<tr><td class="label">Packaging</td><td class="value" id="breakPackaging"></td><td class="value" id="breakPackagingPct"></td></tr>
<tr><td class="label">Electricity</td><td class="value" id="breakElec"></td><td class="value" id="breakElecPct"></td></tr>
<tr><td class="label">Overheads</td><td class="value" id="breakOverhead"></td><td class="value" id="breakOverheadPct"></td></tr>
<tr><td class="label">Local Transport</td><td class="value" id="breakLocal"></td><td class="value" id="breakLocalPct"></td></tr>
<tr><td class="label">Export Freight</td><td class="value" id="breakFreight"></td><td class="value" id="breakFreightPct"></td></tr>
</table>
</section>

<section id="sellingPrice">
<h2>ğŸ’µ Selling Price & Profit</h2>
<label>Selling Price / Roll (USD)</label><input id="sellingPriceInput" value="0">
<span class="output">Net Profit (USD): <span id="netProfitUSD">0.000</span></span>
<span class="output">Profit (%): <span id="profitPct">0.00%</span></span>

<button id="whatsappBtn">
  <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg"> Share on WhatsApp
</button>
</section>

<script>
function f(n){return Number(n).toLocaleString(undefined,{minimumFractionDigits:3,maximumFractionDigits:3});}
function g(id){return parseFloat(document.getElementById(id).value.replace(/,/g,''))||0;}

function calculate(){
const ex=g('exchangeRate');

// Tissue Weight
const tissueWeight=g('ply')*g('gsm')*g('sheets')*(g('sheetWidth')*g('sheetLength'))/10000;
document.getElementById('tissueWeight').textContent=f(tissueWeight);

// Raw Material
const raw=(tissueWeight/1e6*g('tissueCostTon')*(1+g('wastage')/100))+(g('coreWeight')/1e6*g('coreCostTon'));
document.getElementById('totalRawMaterial').textContent=f(raw);

// Packaging
const packaging=(g('singleWrap')+g('bundleWrap')/g('rollsPerBundle'))/ex;
document.getElementById('packagingCost').textContent=f(packaging);

// Production
const monthlyProduction = g('rollsPerHour') * g('hours') * g('shifts') * g('days');
document.getElementById('monthlyProduction').textContent = f(monthlyProduction);

const units=g('load')*(g('usage')/100)*g('hours')*g('shifts')*g('days');
const elec=(units*g('unitRate')/ex)/monthlyProduction;
document.getElementById('elecCostRoll').textContent=f(elec);

// Overheads
const overhead=((g('rent')+g('labor')+g('misc'))/ex)/monthlyProduction;
document.getElementById('overheadPerRoll').textContent=f(overhead);

// Local Transport
const local=((g('localTransportPKR')/ex)+g('clearingUSD'))/g('rollsPerContainerLocal');
document.getElementById('localTransportCost').textContent=f(local);

// Export Freight
const freight=g('oceanFreight')/g('rollsPerContainerExport');
document.getElementById('freightPerRoll').textContent=f(freight);

// Final Cost
const total=raw+packaging+elec+overhead+local+freight;
document.getElementById('costPerRoll').textContent=f(total);
document.getElementById('costPerTon').textContent=f(total*1e6/tissueWeight);

// Final Breakdown %
const items=[raw,packaging,elec,overhead,local,freight];
['breakRaw','breakPackaging','breakElec','breakOverhead','breakLocal','breakFreight']
.forEach((id,i)=>document.getElementById(id).textContent=f(items[i]));
['breakRawPct','breakPackagingPct','breakElecPct','breakOverheadPct','breakLocalPct','breakFreightPct']
.forEach((id,i)=>document.getElementById(id).textContent=(items[i]/total*100).toFixed(2)+'%');

// Selling Price & Profit
const selling=g('sellingPriceInput');
const profit=selling-total;
document.getElementById('netProfitUSD').textContent=f(profit);
document.getElementById('profitPct').textContent=((profit/total)*100).toFixed(2)+'%';
}

document.querySelectorAll('input').forEach(i=>i.addEventListener('input',calculate));
calculate();

// WhatsApp share button
document.getElementById('whatsappBtn').addEventListener('click', () => {
    function gtxt(id){return document.getElementById(id).value || document.getElementById(id).textContent || '';}
    let msg = `ğŸ“„ Paper Conversion Calculator Results:\n\n`;

    msg += `ğŸ’± Exchange Rate: ${gtxt('exchangeRate')}\n`;
    msg += `ğŸ“„ Paper Spec:\n  Ply: ${gtxt('ply')}, GSM: ${gtxt('gsm')}, Sheets: ${gtxt('sheets')}, Width: ${gtxt('sheetWidth')}, Length: ${gtxt('sheetLength')}, Tissue Weight: ${gtxt('tissueWeight')} g\n`;
    msg += `ğŸ’° Raw Material / Roll: $${gtxt('totalRawMaterial')}\n`;
    msg += `ğŸ“¦ Packaging / Roll: $${gtxt('packagingCost')}\n`;
    msg += `âš¡ Production:\n  Rolls/Month: ${gtxt('monthlyProduction')}, Electricity/Roll: $${gtxt('elecCostRoll')}\n`;
    msg += `ğŸ¢ Overheads / Roll: $${gtxt('overheadPerRoll')}\n`;
    msg += `ğŸšš Local Transport / Roll: $${gtxt('localTransportCost')}\n`;
    msg += `ğŸŒŠ Export Freight / Roll: $${gtxt('freightPerRoll')}\n`;
    msg += `ğŸ’² Total Cost / Roll: $${gtxt('costPerRoll')}, Cost / Ton: $${gtxt('costPerTon')}\n`;
    msg += `ğŸ’µ Selling Price / Roll: $${gtxt('sellingPriceInput')}, Net Profit: $${gtxt('netProfitUSD')} (${gtxt('profitPct')})\n`;

    const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
    window.open(url, '_blank');
});
</script>

</body>
</html>