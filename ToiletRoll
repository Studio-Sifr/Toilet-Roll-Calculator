<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Toilet Roll Cost Calculator</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f0f0f0; }
header { background:#333; color:#fff; padding:10px; text-align:center; font-size:1.5em; }
section { padding:15px; margin:10px; border-radius:8px; }
h2 { margin-top:0; cursor:pointer; }
input[type="number"] { width:100px; }
.toggle-btn { cursor:pointer; font-size:0.9em; color:#007bff; }
#results { background:#ddd; padding:15px; }
.blue { background:#cce5ff; }
.green { background:#d4edda; }
.yellow { background:#fff3cd; }
.orange { background:#ffe5b4; }
.purple { background:#e6ccff; }
.pink { background:#ffcce6; }
.collapsible { cursor:pointer; padding:10px; border:none; text-align:left; outline:none; font-size:1em; width:100%; }
.content { display:none; padding:0 10px; }
#pdfBtn { margin-top:10px; padding:10px 15px; cursor:pointer; }
</style>
</head>
<body>

<header>Toilet Roll Cost Calculator</header>

<!-- Currency & Exchange Rate -->
<section class="yellow">
<label>Currency: </label>
<select id="currency">
<option value="USD">USD</option>
<option value="PKR">PKR</option>
</select>
<label>Exchange Rate (PKR per USD): </label>
<input type="number" id="fxRate" value="280">
</section>

<!-- Section 1: Raw Material -->
<section class="blue">
<h2 class="collapsible">Raw Material / Tissue Specs</h2>
<div class="content">
<label>Paper GSM: <input type="number" id="gsm" value="15"></label><br>
<label>Sheet Width (cm): <input type="number" id="sheetW" value="10.16"></label><br>
<label>Sheet Length (cm): <input type="number" id="sheetL" value="10.16"></label><br>
<label>Sheets per Roll: <input type="number" id="sheetsPerRoll" value="500"></label><br>
<label>Ply: <input type="number" id="plies" value="2"></label><br>
<label>Core Weight (g): <input type="number" id="coreWeight" value="10"></label><br>
<label>Jumbo Roll Price per Ton (USD): <input type="number" id="jumboPrice" value="1100"></label><br>
<label>Core Price per Ton (USD): <input type="number" id="corePrice" value="1200"></label><br>
<label>Wastage %: <input type="number" id="wastage" value="5"></label><br>
</div>
</section>

<!-- Section 2: Packaging -->
<section class="green">
<h2 class="collapsible">Packaging</h2>
<div class="content">
<label>Single Roll Package Cost (USD): <input type="number" id="packSingle" value="0.02"></label><br>
<label>Bundle Package Cost (USD): <input type="number" id="packBundle" value="0.05"></label><br>
<label>Items per Bundle: <input type="number" id="itemsPerBundle" value="10"></label>
</div>
</section>

<!-- Section 3: Overheads -->
<section class="yellow">
<h2 class="collapsible">Fixed Overheads</h2>
<div class="content">
<label>Rent per month (USD): <input type="number" id="rent" value="5000"></label><br>
<label>Labor per month (USD): <input type="number" id="labor" value="4000"></label><br>
<label>Misc per month (USD): <input type="number" id="misc" value="1000"></label>
</div>
</section>

<!-- Section 4: Electricity -->
<section class="orange">
<h2 class="collapsible">Electricity / Production</h2>
<div class="content">
<label>Connected Load (kW): <input type="number" id="load" value="50"></label><br>
<label>% Average Used: <input type="number" id="loadPct" value="70"></label><br>
<label>Units Used per Hour: <input type="number" id="unitsPerHr" value="35"></label><br>
<label>Rate per Unit (USD): <input type="number" id="rateUnit" value="0.12"></label><br>
<label>Production per Hour (rolls): <input type="number" id="prodPerHr" value="1000"></label><br>
<label>Hours per Shift: <input type="number" id="hrsShift" value="8"></label><br>
<label>Shifts per Day: <input type="number" id="shifts" value="1"></label><br>
<label>Days per Month: <input type="number" id="days" value="25"></label>
</div>
</section>

<!-- Section 5: Transport -->
<section class="purple">
<h2 class="collapsible">Transport</h2>
<div class="content">
<label>FOB per Container (USD): <input type="number" id="fob" value="25500"></label><br>
<label>Local Transport per Container (PKR): <input type="number" id="localTrans" value="50000"></label><br>
<label>Total Rolls per Container: <input type="number" id="rollsPerContainer" value="60000"></label>
</div>
</section>

<!-- Section 6: Freight -->
<section class="pink">
<h2 class="collapsible">Freight</h2>
<div class="content">
<label>Freight per Container (USD): <input type="number" id="freight" value="4000"></label><br>
<label>Total Rolls per Container: <input type="number" id="freightRolls" value="60000"></label>
</div>
</section>

<!-- Results -->
<section id="results">
<h2>Results</h2>
<div id="resultsContent"></div>
<button id="pdfBtn">Export to PDF</button>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
function calculate() {
    const fx = Number(document.getElementById('fxRate').value);
    const currency = document.getElementById('currency').value;

    // Section 1: Raw Material
    const gsm = Number(document.getElementById('gsm').value);
    const sheetW = Number(document.getElementById('sheetW').value);
    const sheetL = Number(document.getElementById('sheetL').value);
    const sheetsPerRoll = Number(document.getElementById('sheetsPerRoll').value);
    const plies = Number(document.getElementById('plies').value);
    const coreW = Number(document.getElementById('coreWeight').value);
    const jumboPrice = Number(document.getElementById('jumboPrice').value);
    const corePrice = Number(document.getElementById('corePrice').value);
    const wastage = Number(document.getElementById('wastage').value)/100;

    const area = sheetW*sheetL*sheetsPerRoll*plies/10000; // mÂ²
    let rollWeight = gsm*area*1000 + coreW; // g
    rollWeight *= (1 + wastage);
    const rollsPerTon = 1000000 / rollWeight;
    const tissueCostPerRoll = rollWeight*jumboPrice/1000000 + coreW*corePrice/1000000;

    // Section 2: Packaging
    const packSingle = Number(document.getElementById('packSingle').value);
    const packBundle = Number(document.getElementById('packBundle').value);
    const itemsPerBundle = Number(document.getElementById('itemsPerBundle').value);
    const packCost = packSingle + (packBundle/itemsPerBundle);

    // Section 3: Overheads
    const rent = Number(document.getElementById('rent').value);
    const labor = Number(document.getElementById('labor').value);
    const misc = Number(document.getElementById('misc').value);
    const overheadPerRoll = (rent+labor+misc)/ (rollsPerTon*1); // approximate per ton

    // Section 4: Electricity
    const unitsPerHr = Number(document.getElementById('unitsPerHr').value);
    const rateUnit = Number(document.getElementById('rateUnit').value);
    const hrsShift = Number(document.getElementById('hrsShift').value);
    const shifts = Number(document.getElementById('shifts').value);
    const days = Number(document.getElementById('days').value);
    const totalUnits = unitsPerHr*hrsShift*shifts*days;
    const elecCost = totalUnits*rateUnit;
    const elecPerRoll = elecCost/ (rollsPerTon*1);

    // Section 5: Transport
    const fob = Number(document.getElementById('fob').value);
    const localTrans = Number(document.getElementById('localTrans').value);
    const rollsPerContainer = Number(document.getElementById('rollsPerContainer').value);
    const fobPerRoll = fob/rollsPerContainer;
    const localPerRoll = (localTrans/rollsPerContainer)/fx;
    const transportPerRoll = fobPerRoll + localPerRoll;

    // Section 6: Freight
    const freight = Number(document.getElementById('freight').value);
    const freightRolls = Number(document.getElementById('freightRolls').value);
    const freightPerRoll = freight/freightRolls;

    let totalPerRoll = tissueCostPerRoll + packCost + overheadPerRoll + elecPerRoll + transportPerRoll + freightPerRoll;
    let totalPerTon = totalPerRoll * rollsPerTon;

    if(currency==='PKR'){
        totalPerRoll *= fx;
        totalPerTon *= fx;
    }

    document.getElementById('resultsContent').innerHTML = `
    <strong>Total Roll Weight (g):</strong> ${rollWeight.toFixed(2)}<br>
    <strong>Rolls per Ton:</strong> ${rollsPerTon.toFixed(2)}<br>
    <strong>Total Cost per Roll (${currency}):</strong> ${totalPerRoll.toFixed(3)}<br>
    <strong>Total Cost per Ton (${currency}):</strong> ${totalPerTon.toFixed(2)}<br>
    `;
}

document.querySelectorAll('input, select').forEach(el=>el.addEventListener('input', calculate));
document.getElementById('currency').addEventListener('change', calculate);

calculate();

// Collapsible sections
var coll = document.getElementsByClassName("collapsible");
for (let i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    content.style.display = content.style.display === "block" ? "none" : "block";
  });
}

// PDF export
document.getElementById('pdfBtn').addEventListener('click', () => {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.text(document.getElementById('resultsContent').innerText, 10, 10);
  doc.save("Toilet_Roll_Cost_Calculator.pdf");
});
</script>
</body>
</html>
